---
title: "Generador de reportes utilizando recursos de Azure" 
img: "/portfolio-images/pokeapi.png"
---
**Fecha**: Agosto-2025  
**Descripci贸n**: Implementaci贸n de nuevas funcionalidades para el generador de reportes de Pok茅mon  
**Tecnolog铆as**: Next.js, FastAPI, Azure Functions, Azure SQL, Blob Storage, Terraform  

---

## Descripci贸n del Proyecto

El Generador de Reportes es una aplicaci贸n que permite crear reportes en formato CSV con informaci贸n detallada de Pok茅mon basados en su tipo. El sistema fue mejorado con tres funcionalidades clave: 
- *eliminaci贸n completa de reportes* 
- *enriquecimiento de datos*
- *muestreo aleatorio*.

**Prop贸sito**: Automatizar la generaci贸n de reportes personalizables con estad铆sticas detalladas de Pok茅mon, optimizando el almacenamiento y procesamiento en la nube.

---

## Arquitectura

El sistema sigue una arquitectura serverless con los siguientes componentes:

### 1. **Repositorios y Contenedores**
- **ACR (Azure Container Registry)**: Almacena las im谩genes de contenedor utilizadas para desplegar los servicios.
- **API Repository**: Contiene el c贸digo fuente y configuraci贸n de la API en Python.
- **UI Repository**: Contiene el c贸digo fuente y configuraci贸n de la interfaz desarrollada en Next.js.

---

### 2. **Capa de Aplicaci贸n**
- **API Webapp (Python)**: Exposici贸n de endpoints que interact煤an con la base de datos y otros servicios.
- **UI Webapp (Next.js)**: Interfaz interactiva para los usuarios finales, conectada a la API.

---

### 3. **Base de Datos**
- **DB Server**: Servidor de bases de datos SQL en Azure.

---

### 4. **Almacenamiento en la Nube**
- **Storage Account**: Proporciona almacenamiento centralizado.
  - **Blob Storage**: Guarda archivos CSV.
  - **Queue Storage**: Sistema de colas para manejar tareas as铆ncronas y mensajer铆a interna.

---

### 5. **Funciones Serverless**
- **Function App**: Procesa eventos desencadenados por la Queue Storage. Conectada tanto al **Queue Storage** como a la **PokeAPI** para procesar informaci贸n y actualizar datos en el sistema.

---

### 6. **Servicio Externo**
- **PokeAPI**: API p煤blica de donde se obtiene la informaci贸n base de los pokemons.  

---



## Tecnolog铆as Clave

**Frontend** (Next.js): Interfaz de usuario para solicitar reportes, Visualizaci贸n de reportes generados, Funcionalidad de eliminaci贸n

**Backend** (FastAPI): API REST para gesti贸n de reportes, Comunicaci贸n con base de datos, Blob Storage y Worker

**Worker** (Azure Function): Procesamiento as铆ncrono, Consulta a la PokeAPI y Generaci贸n de CSV con Pandas

**Almacenamiento**: Azure SQL Database (metadatos), Blob Storage (archivos CSV)

**Infraestructura**: Terraform para provisionamiento

---

---
## Funcionalidades Implementadas

### Tarea 1: Eliminaci贸n Completa de Reportes

**Implementaci贸n**:

**Frontend**:
- Bot贸n de eliminaci贸n con modal de confirmaci贸n 
- Actualizaci贸n din谩mica de la lista tras eliminaci贸n (renderizaci贸n nueva)

**Backend**:
- Nuevo endpoint *`DELETE /api/report/{id}`*
- Eliminaci贸n de csv en Blob Storage y su registro en la base de datos SQL Server

### Tarea 2: Enriquecimiento de csv

**Implementaci贸n**:

**Worker Azure Function**:
- Se agregaron los siguientes campos al CSV: *experience, height, weight, type, img_url, abilities*
        ```python
          
          pokemon['pokemon']['experience'] = pokemon_data['base_experience']
          pokemon['pokemon']['height'] = pokemon_data['height']
          pokemon['pokemon']['weight'] = pokemon_data['weight']
          pokemon['pokemon']['type'] = data.get('name')
          pokemon['pokemon']['img_url'] = pokemon_data['sprites']['front_default']
          abilities = ''
          for abilitie in pokemon_data['abilities']:
              abilities += f'{abilitie['ability']['name']},' 
          pokemon['pokemon']['abilities'] = abilities[:-1]
          

        ```

### Tarea 3: Muestreo

**Implementaci贸n**:

**Frontend**:
- Se agreg贸 input para agregar un *sample_size*
- Validaci贸n que *sample_size* sea positivo

**Backend**:
- Se modific贸 el modelo *PokemonRequest* para aceptar el campo *sample_size*
- Recibe el campo *sample_size* en el objeto request
- Valida el campo *sample_size*
- Env铆a a la Queue el *sample_size* junto con el *id*

**Base de datos**:
- Se agreg贸 el campo *sample_size* a la tabla *requests*
- Se modific贸 el procedimiento almacenado *create_poke_request* para que acepte el campo *sample_size* y lo retorne con el *id*

**Worker Azure Function**:
- Recupera el campo *sample_size* de la Azure Queue
- Valida si *sample_size* es menor al tama帽o de lista de pokemons
- Implementa random.sample para el muestreo

---

## Desaf铆os

**Investigaci贸n**:
    - Tuve que realizar la investigaci贸n sobre c贸mo se realiza la eliminaci贸n de un recurso en el *Blob Storage*, el cual aunque es solamente una sola funci贸n requiere de investigaci贸n.
    
**Navegaci贸n en repositorio existente**:
    - Deber aprender sobre los repositorios base para poder modificarlos es un gran reto con grandes recompensas. Practiqu茅 mis capacidades para poder navegar y modificar c贸digo existente, sumamente importante no solamente para el proyecto pero para la vida laboral en general.
    - De igual forma, como ya exist铆a un repositorio base, la configuraci贸n para levantar el proyecto sin errores conllev贸 bastante tiempo, incluso m谩s que de desarrollo (o al menos fue mayor el estr茅s para levantar el proyecto ).



---

## Enlaces

### Repositorios

- [Terraform/infra](https://github.com/carlos-fl/terraform-pokeapi)
- [UI/Frontend](https://github.com/carlos-fl/pokeapi-ui)
- [Worker Function Python](https://github.com/carlos-fl/pokeapi-function)
- [Scripts](https://github.com/carlos-fl/pokeapi-scripts)
- [pokeapi-api](https://github.com/carlos-fl/pokeapi-api)

### Servicios desplegados

- [API](https://api-pokequeue-dev-1802.azurewebsites.net/)
- [UI](https://ui-pokequeue-dev-1802.azurewebsites.net/)

--- 
